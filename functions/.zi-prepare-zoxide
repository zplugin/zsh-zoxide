#autoload
# -*- mode: zsh; sh-indentation: 2; indent-tabs-mode: nil; sh-basic-offset: 2; -*-
# vim: ft=zsh sw=2 ts=2 et

builtin emulate -L zsh ${=${options[xtrace]:#off}:+-o xtrace}
builtin setopt extended_glob warn_create_global \
typeset_silent no_short_loops rc_quotes no_auto_pushd

# - The directory in which the database is stored.
# - Manpages copied to set / default localtion.
if (( ${ZI[SOURCED]} )) && [[ -d ${ZPFX} ]]; then
  if [[ ! -d ${ZPFX}/share ]]; then
    command mkdir -p ${ZPFX}/share || \
    +zi-message "{error}Failed to create directory for database.{rst}"
  fi
  typeset -g _ZO_DATA_DIR=${ZPFX}/share
  if [[ -d ${ZI[MAN_DIR]} ]] && [[ -d ${Plugins[ZSH_ZOXIDE]}/man/man1 ]]; then
    cp ${Plugins[ZSH_ZOXIDE]}/man/man1/* ${ZI[MAN_DIR]}/man1/ || \
    +zi-message "{error}Failed to install manpages.{rst}"
  fi
fi

# Set zoxide commands x, xi when using with Zi.
if (( ${ZI[SOURCED]} )) && \
(( ${+functions[zi]} )) && [[ -z ${_ZO_CMD_PREFIX} ]]; then
  typeset -g _ZO_CMD_PREFIX=x
fi
